{% block friends %}
<div class="colSize p-3 bg-light border border-light border-opacity-25 bg-opacity-25 rounded shadow text-light">
	<h2 class="mb-4">Friends</h2>
	<div class="mb-4">
		<div class="ms-3 mt-3 d-flex align-items-center">
			<h5>Friends<i class="bi bi-people-fill ms-2"></i></h5>
		</div>
		<hr class="col-10 mt-0 mb-3 mx-auto">
		{% if friends|length == 0 %}
			<p class="ms-5">No friends yet</p>
		{% else %}
			<ul class="list-unstyled overflow-auto" style="height: 130px;">
				{% for friend in friends %}
					<li class="mb-2">
						<div class="d-flex justify-content-between align-items-center col-10 bg-white bg-opacity-25 mb-2 rounded shadow-sm mx-auto p-3">
							<div class="d-flex align-items-center">
								<img class="rounded-circle me-2 border border-2 border-success" src="{{ friend.avatar.url }}" alt="Friend avatar" style="width: 35px; height: 35px;">
								<div style="max-width: 7ch; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;">
									{{ friend.username }}
								</div>
							</div>
							<button class="btn buttonfriends btn-sm btn-dark shadow-sm" style="--bs-btn-font-size: .75rem;"
							data-bs-toggle="modal" data-bs-target="#friendsProfile">
							profile
							</button>
						</div>
					</li>
				{% endfor %}
			</ul>
		{% endif %}
	</div>
	<div class="mb-4">
		<div class="ms-3 d-flex align-items-center">
			<h5>Users<i class="bi bi-people ms-2"></i></h5>
		</div>
		<hr class="col-10 mt-0 mb-3 mx-auto">
		<ul class="list-unstyled overflow-auto" >
			{% for user in users %}
				{% if user not in friends %}
				<li>
					<div class="d-flex justify-content-between align-items-center col-10 bg-white bg-opacity-25 p-3 mb-2 rounded shadow-sm mx-auto">
						<div class="d-flex align-items-center">
							<img class="rounded-circle me-2" src="{{ user.avatar.url }}" alt="" style="width: 35px; height: 35px;">
							<div style="max-width: 7ch; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;">
								{{ user.username }}
							</div>
						</div>
						{% if user.username in invites %}
						<form action="handle_invite" method="POST">
							{% csrf_token %}
							<input type="hidden" name="invite" value="{{ user.username }}">
							<button type="submit" name="status" value="accepted" class="btn buttonvalid px-2 btn-sm btn-primary shadow-sm"
							style="--bs-btn-font-size: .75rem;"><i class="bi bi-check-square"></i></button>
							<button type="submit" name="status" value="declined" class="px-2 buttonvalid btn btn-sm btn-danger shadow-sm"
							style="--bs-btn-font-size: .75rem;"><i class="bi bi-x-square"></i></button>
						</form>
						{% elif user.username in invitees %}
						<button class="btn buttonfriends btn-sm btn-primary shadow-sm" disabled
						style="--bs-btn-font-size: .75rem;">pending</button>
						{% else %}
						<form action="send_invite" method="POST">
							{% csrf_token %}
							<input type="hidden" name="receiver" value="{{ user.username }}">
							<button class="btn buttonfriends btn-sm btn-primary shadow-sm" type="submit"
							style="--bs-btn-font-size: .75rem;">add friend</button>
						</form>
						{% endif %}
					</div>
				</li>
				{% endif %}
			{% endfor %}
		</ul>
	</div>
</div>		
{% endblock friends %}